var Ee=Object.defineProperty;var de=s=>{throw TypeError(s)};var Se=(s,i,e)=>i in s?Ee(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e;var c=(s,i,e)=>Se(s,typeof i!="symbol"?i+"":i,e),me=(s,i,e)=>i.has(s)||de("Cannot "+e);var t=(s,i,e)=>(me(s,i,"read from private field"),e?e.call(s):i.get(s)),o=(s,i,e)=>i.has(s)?de("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(s):i.set(s,e),l=(s,i,e,n)=>(me(s,i,"write to private field"),n?n.call(s,e):i.set(s,e),e);import{Q as x,a_ as Ie,g as j,a3 as Le,L as Pe,a$ as Ce}from"./DTbFyfnF.js";const Ne=s=>{let i=!1,e=[];const n=new Map,r=new window.ResizeObserver((a,u)=>{e=e.concat(a),i||window.requestAnimationFrame(()=>{const h=new Set;for(let f=0;f<e.length;f++){if(h.has(e[f].target))continue;h.add(e[f].target);const p=n.get(e[f].target);p==null||p.forEach(d=>d(e[f],u))}e=[],i=!1}),i=!0});return{observer:r,subscribe(a,u){r.observe(a);const h=n.get(a)??[];h.push(u),n.set(a,h)},unsubscribe(a,u){const h=n.get(a)??[];if(h.length===1){r.unobserve(a),n.delete(a);return}const f=h.indexOf(u);f!==-1&&h.splice(f,1),n.set(a,h)}}};let ae;const ve=s=>ae||(ae=Ne()),ke=(s,i)=>Math.hypot(s,i),Te=(s,i,e=!1)=>{if(i.length===0)return-1;let n=0,r=Math.abs(s-i[0]);for(let a=1;a<i.length;a++){const u=Math.abs(s-i[a]);if(u<r)n=a,r=u;else if(e)break}return n},pe=(s,i,e)=>i===0||Math.abs(i)===Number.POSITIVE_INFINITY?s**(e*5):s*i*e/(i+e*s),ye=(s,i,e,n=.15)=>n===0?x.Clamp(s,i,e):s<i?-pe(i-s,e-i,n)+i:s>e?+pe(s-e,e-i,n)+e:s,xe=()=>{},be={mouse:!0,touch:!0,minX:Number.NEGATIVE_INFINITY,minY:Number.NEGATIVE_INFINITY,maxX:Number.POSITIVE_INFINITY,maxY:Number.POSITIVE_INFINITY,passive:!0,rubber:!0,preventDefault:!1,cancelPointerEvents:!0},ge=s=>{const i={...be,...typeof s=="function"?s():s};return i.preventDefault&&(i.passive=!1),i},le=s=>"TouchEvent"in window&&s instanceof TouchEvent?{x:s.changedTouches[0].clientX,y:s.changedTouches[0].clientY}:{x:s.clientX,y:s.clientY};var C,y,N;class Me{constructor(i,e,n){c(this,"state",{event:null,target:null,currentTarget:null,active:!1,first:!1,last:!1,delta:{x:0,y:0},direction:{x:0,y:0},pointer:{x:0,y:0},movement:{x:0,y:0},offset:{x:0,y:0},velocity:{x:0,y:0},tap:!0,canceled:!1,cancel:xe});o(this,C,!1);o(this,y,be);o(this,N,!1);c(this,"config");c(this,"element");c(this,"handler");c(this,"drag",i=>{var oe,ce,ue,fe;if(t(this,C))return;l(this,C,!0),(ce=(oe=t(this,y)).beforeStart)==null||ce.call(oe,this.state),l(this,y,ge(this.config));const e=this.state,n=t(this,y);n.preventDefault&&i.preventDefault(),e.target=i.target,e.currentTarget=i.currentTarget,e.active=!1,e.tap=!0;const r=le(i),a={x:0,y:0},u={x:0,y:0};let h=r,f,p;((ue=n.from)==null?void 0:ue.x)!==void 0&&(e.offset.x=n.from.x),((fe=n.from)==null?void 0:fe.y)!==void 0&&(e.offset.y=n.from.y),e.currentTarget.style.userSelect="none",e.currentTarget.style.webkitUserSelect="none";const d=g=>{const W=h;if(h=le(g),e.direction.x=Math.sign(h.x-W.x),e.direction.y=Math.sign(h.y-W.y),e.active){e.event=g,e.first=!1,e.pointer=h,a.x=e.pointer.x-r.x,a.y=e.pointer.y-r.y;const D={...e.offset};e.offset.x=n.rubber?ye(u.x+a.x,n.minX,n.maxX):x.Clamp(u.x+a.x,n.minX,n.maxX),e.offset.y=n.rubber?ye(u.y+a.y,n.minY,n.maxY):x.Clamp(u.y+a.y,n.minY,n.maxY),p=g.timeStamp-f,e.velocity.x=e.delta.x/p,e.velocity.y=e.delta.y/p,e.delta.x=e.offset.x-D.x,e.delta.y=e.offset.y-D.y,e.movement.x+=e.delta.x,e.movement.y+=e.delta.y,f=g.timeStamp,this.handler(e)}else{const D=Math.abs(h.x-r.x),re=Math.abs(h.y-r.y);if(n.axis==="x"&&D<re){m();return}if(n.axis==="y"&&re<D){m();return}ke(D,re)>3&&b(g)}},b=g=>{e.event=g,e.active=!0,e.tap=!1,e.first=!0,e.last=!1,e.canceled=!1,e.delta={x:0,y:0},e.velocity={x:0,y:0},e.pointer=le(g),e.movement={x:0,y:0},u.x=e.offset.x,u.y=e.offset.y,f=g.timeStamp,this.handler(e)},m=()=>{var W;l(this,C,!1);const g=e.active;e.last=g,e.active=!1,e.offset.x=x.Clamp(e.offset.x,n.minX,n.maxX),e.offset.y=x.Clamp(e.offset.y,n.minY,n.maxY),e.currentTarget.style.userSelect="",e.currentTarget.style.webkitUserSelect="",window.removeEventListener("touchmove",d),window.removeEventListener("touchend",m),window.removeEventListener("touchcancel",m),window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",m),(g||e.tap)&&this.handler(e),(W=n.afterEnd)==null||W.call(n,e)};i instanceof MouseEvent?(window.addEventListener("mousemove",d,{passive:!1}),window.addEventListener("mouseup",m,{passive:!1})):(window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("touchend",m,{passive:!1}),window.addEventListener("touchcancel",m,{passive:!1})),e.cancel=()=>{e.canceled||(l(this,C,!1),e.canceled=!0,setTimeout(()=>m(),0))}});c(this,"click",i=>{!this.state.tap&&i.detail>0&&(i.preventDefault(),i.stopPropagation())});c(this,"clean",()=>{var i,e,n;t(this,N)&&(t(this,y).touch&&((i=this.element)==null||i.removeEventListener("touchstart",this.drag)),t(this,y).mouse&&((e=this.element)==null||e.removeEventListener("mousedown",this.drag)),(n=this.element)==null||n.removeEventListener("click",this.click,!0),l(this,N,!1))});c(this,"init",()=>{var i,e,n;t(this,N)||(l(this,y,ge(this.config)),t(this,y).touch&&((i=this.element)==null||i.addEventListener("touchstart",this.drag,{passive:t(this,y).passive})),t(this,y).mouse&&((e=this.element)==null||e.addEventListener("mousedown",this.drag,{passive:t(this,y).passive})),(n=this.element)==null||n.addEventListener("click",this.click,!0),l(this,N,!0))});this.element=i,this.handler=e||xe,this.config=n}}C=new WeakMap,y=new WeakMap,N=new WeakMap;var w;class we{constructor(){o(this,w,new Map);c(this,"on",(i,e)=>{t(this,w).has(i)?t(this,w).get(i).add(e):t(this,w).set(i,new Set([e]))});c(this,"off",(i,e)=>{t(this,w).has(i)&&t(this,w).get(i).delete(e)});c(this,"emit",(i,...e)=>{t(this,w).has(i)&&t(this,w).get(i).forEach(n=>n(...e))})}clean(){t(this,w).clear()}}w=new WeakMap;const Ye={immediate:!1,sync:!1,inertia:!1,easing:"spring",min:-1/0,max:1/0},ze=s=>()=>(s.idle=!0,s.to),Xe=(s,{tension:i=170,friction:e=26,mass:n=1,velocity:r})=>{const a=e/(2*Math.sqrt(i*n)),u=Math.sqrt(i/n)*.001,h=u*Math.sqrt(1-a*a),f=r??s.startVelocity;return function(){const d=s.elapsed;let b;if(a<1){const m=Math.exp(-a*u*d);b=s.to-m*((-f+a*u*s.x0)/h*Math.sin(h*d)+s.x0*Math.cos(h*d))}else{const m=Math.exp(-u*d);b=s.to-m*(s.x0+(-f+u*s.x0)*d)}return b}},Ve=(s,{factor:i=.05})=>function(){return x.Lerp(s.value,s.to,i)},_e=(s,{momentum:i=.998,snapPoints:e,velocity:n,min:r=-1/0,max:a=1/0})=>{const u=n??s.startVelocity,h=(d=s.elapsed)=>{const b=Math.exp(-(1-i)*d),m=s.from+u/(1-i)*(1-b);return x.Clamp(m,r,a)},f=-1/(1-i)*Math.log(.02);s.to=h(f),s.x0=s.to-s.from;const p=s.to>=a||s.to<=r;if(e||p){if(e){const d=Te(s.to,e,!0);s.to=e[d]}return s.x0=s.to-s.from,s.inertia=!1,ee.spring(s,{tension:28,friction:30,velocity:s.velocity})}return h},ee={immediate:ze,spring:Xe,lerp:Ve,damping:_e};var P,k,U;class De extends we{constructor(e,n){super();o(this,P);c(this,"key");c(this,"ticker");c(this,"init",(e,n)=>{l(this,P,typeof e=="function"?e():e),this.key=n});c(this,"startVelocity",0);c(this,"elapsed",0);c(this,"from",0);c(this,"to",0);c(this,"x0",0);c(this,"idle",!0);c(this,"inertia",!1);c(this,"velocity",0);o(this,k,"spring");o(this,U,0);c(this,"update",()=>{});c(this,"stop",()=>{this.ticker.remove(this.update),this.emit("stop")});c(this,"set",(e,n)=>{const r={...Ye,...n};if(this.from=this.value,this.to=x.Clamp(e,r.min,r.max),this.x0=this.to-this.from,this.elapsed=0,this.startVelocity=this.velocity,this.inertia=r.inertia,l(this,k,r.easing),r.distancePrecision??(r.distancePrecision=r.snapPoints?.5:t(this,k)==="spring"?.01:.1),r.velocityPrecision??(r.velocityPrecision=r.snapPoints?.2:t(this,k)==="spring"?.001:.01),r.sync){this.value=this.to;return}let a;const u=new Promise(f=>a=f);if(this.to===this.value&&!r.inertia){this.idle=!0,this.velocity=0;return}this.idle=!1;const h=r.immediate?ee.immediate(this):this.inertia?ee.damping(this,r):ee[t(this,k)](this,r);return this.stop(),this.update=f=>{if(this.idle){this.stop(),a(void 0),l(this,U,window.setTimeout(()=>this.velocity=0,50));return}const p=f.dt*1e3;this.elapsed+=p;const d=h(),b=x.Clamp(d,r.min,r.max);if(this.velocity=(b-this.value)/p,this.inertia&&Math.abs(this.velocity)<r.velocityPrecision||Math.abs(this.to-b)<r.distancePrecision&&Math.abs(this.velocity)<r.velocityPrecision){this.inertia||(this.value=this.to),this.idle=!0;return}this.value=b},clearTimeout(t(this,U)),this.ticker.add(this.update),this.emit("start"),u});c(this,"clean",()=>{super.clean(),this.stop()});this.ticker=Ie(),e&&this.init(e,n)}get value(){return this.key?t(this,P)[this.key]:t(this,P)}set value(e){e!==this.value&&(this.emit("change",e),this.key?t(this,P)[this.key]=e:l(this,P,e))}}P=new WeakMap,k=new WeakMap,U=new WeakMap;var B,F,E,O,M,S,q,G,Y,z,$,I,R,T,X,V,v,he,A,te,L,se,Q,_,H,J,ie,ne,K,Z;class Ae extends we{constructor(){super(...arguments);o(this,v);c(this,"element",null);c(this,"snapPoints",[]);o(this,B,0);o(this,F);o(this,E);o(this,O);o(this,M,0);o(this,S,0);o(this,q,!1);o(this,G,!1);o(this,Y,!1);o(this,z,!1);o(this,$,!1);o(this,I,!1);o(this,R);o(this,T);o(this,X);o(this,V);c(this,"progress",0);o(this,L,()=>{this.element&&(this.element.style.scrollSnapType="")});o(this,se,async({offset:e,first:n,last:r,tap:a})=>{l(this,I,!1);const u=this.element;if(!a){if(n&&(u.style.scrollSnapType="none"),r){l(this,z,!0),await t(this,T).set(-e.x,{inertia:!0,snapPoints:t(this,G)?this.snapPoints:void 0,max:t(this,S),min:0}),l(this,z,!1),t(this,L).call(this);return}t(this,T).set(-e.x,{immediate:!0,max:t(this,S),min:0})}});o(this,Q,()=>{l(this,I,!1),l(this,q,!0)});o(this,_,()=>{l(this,q,!1)});c(this,"wheelStart");c(this,"wheelDist",{x:0,y:0});o(this,H,e=>{t(this,L).call(this),l(this,I,!1),clearTimeout(t(this,X)),l(this,X,setTimeout(t(this,L),50)),t(this,z)&&(l(this,z,!1),t(this,T).stop())});o(this,J,(e=!0)=>{var n,r;(n=t(this,T))==null||n.stop(),t(this,L).call(this),clearTimeout(t(this,E)),!(t(this,q)||!t(this,Y))&&((r=this.element)==null||r.scrollTo({left:this.snapPoints[this.index],behavior:e?"smooth":"instant"}),l(this,E,setTimeout(()=>{l(this,E,void 0),l(this,I,!1)},500)))});o(this,ie,()=>{t(this,I)||!this.element||l(this,v,Te(this.element.scrollLeft,this.snapPoints,!0),te)});o(this,ne,()=>{clearTimeout(t(this,V)),l(this,V,setTimeout(()=>{var e,n;return(n=(e=this.element)==null?void 0:e.children[t(this,v,A)])==null?void 0:n.focus({preventScroll:!0})},200))});o(this,K,e=>{this.element&&(this.progress=x.Clamp(this.element.scrollLeft/this.snapPoints[this.snapPoints.length-1]*(this.snapPoints.length-1),0,t(this,v,he)-1),this.emit("change")),!(!this.element||t(this,E))&&(l(this,E,setTimeout(()=>l(this,E,void 0),150)),t(this,ie).call(this),t(this,ne).call(this))});c(this,"layout",()=>{if(this.element){t(this,L).call(this),l(this,S,this.element.scrollWidth-t(this,M));const e=window.getComputedStyle(this.element);l(this,G,e.scrollSnapType==="x mandatory");const n=~~parseInt(e.paddingLeft),r=~~parseInt(e.scrollPaddingInlineEnd);this.snapPoints=Array.prototype.map.call(this.element.children,a=>{const h=getComputedStyle(a).scrollSnapAlign;return h==="start"?x.Clamp(a.offsetLeft-n,0,t(this,S)):h==="end"?x.Clamp(a.offsetLeft+a.offsetWidth-t(this,M)+r,0,t(this,S)):x.Clamp(a.offsetLeft+a.offsetWidth/2-t(this,M)/2,0,t(this,S))}),clearTimeout(t(this,F)),l(this,F,setTimeout(()=>{t(this,J).call(this,!1)},10))}});o(this,Z,e=>{clearTimeout(t(this,O));const n=()=>{l(this,M,e.borderBoxSize[0].inlineSize),this.layout()};t(this,Y)?l(this,O,setTimeout(n,75)):(n(),l(this,Y,!0),this.emit("ready"))});c(this,"clean",()=>{var n,r;super.clean(),l(this,Y,!1),(n=t(this,R))==null||n.clean(),(r=t(this,T))==null||r.clean();const e=ve();clearTimeout(t(this,E)),clearTimeout(t(this,F)),clearTimeout(t(this,O)),clearTimeout(t(this,X)),clearTimeout(t(this,V)),this.element&&(t(this,L).call(this),e.unsubscribe(this.element,t(this,Z)),this.element.removeEventListener("touchstart",t(this,Q)),this.element.removeEventListener("touchend",t(this,_)),this.element.removeEventListener("touchcancel",t(this,_)),this.element.removeEventListener("scroll",t(this,K)),this.element.removeEventListener("wheel",t(this,H)))})}get index(){return t(this,v,A)}set index(e){const n=t(this,v,A);l(this,v,e,te),n!==t(this,v,A)&&(l(this,I,!0),t(this,J).call(this))}get canScrollPrev(){return this.index>0}get canScrollNext(){return t(this,T)?t(this,T).value<t(this,S):!0}init(e,{index:n=0,mouseDrag:r=!1}={}){this.element=e,this.element.addEventListener("touchstart",t(this,Q),{passive:!0}),this.element.addEventListener("touchend",t(this,_),{passive:!0}),this.element.addEventListener("touchcancel",t(this,_),{passive:!0}),this.element.addEventListener("scroll",t(this,K),{passive:!0}),this.element.addEventListener("wheel",t(this,H),{passive:!0}),l(this,v,n,te),l(this,$,r),t(this,$)&&(l(this,T,new De(e,"scrollLeft")),l(this,R,new Me(this.element,t(this,se),()=>({beforeStart:()=>{t(this,T).stop(),l(this,I,!1),l(this,E,void 0),clearTimeout(t(this,V)),clearTimeout(t(this,X))},rubber:!1,touch:!1,from:{x:-this.element.scrollLeft}}))),t(this,R).init()),ve().subscribe(e,t(this,Z))}}B=new WeakMap,F=new WeakMap,E=new WeakMap,O=new WeakMap,M=new WeakMap,S=new WeakMap,q=new WeakMap,G=new WeakMap,Y=new WeakMap,z=new WeakMap,$=new WeakMap,I=new WeakMap,R=new WeakMap,T=new WeakMap,X=new WeakMap,V=new WeakMap,v=new WeakSet,he=function(){return this.snapPoints.length},A=function(){return t(this,B)},te=function(e){e>=0&&e<t(this,v,he)&&e!==t(this,v,A)&&(l(this,B,e),this.emit("change"))},L=new WeakMap,se=new WeakMap,Q=new WeakMap,_=new WeakMap,H=new WeakMap,J=new WeakMap,ie=new WeakMap,ne=new WeakMap,K=new WeakMap,Z=new WeakMap;const Re=(s,{mouseDrag:i}={})=>{const e=new Ae,n=s.index??j(0),r=s.progress??j(0),a=s.canScrollNext??j(!0),u=s.canScrollPrev??j(!0),h=()=>{n.value=e.index,r.value=e.progress,a.value=e.canScrollNext,u.value=e.canScrollPrev};return Le(n,f=>{f!==e.index&&(e.index=f)}),Pe(()=>(s.element.value&&e.init(s.element.value,{index:n.value,mouseDrag:i}),e.on("change",h),e.on("ready",h),Ce(()=>{e.off("change",h),e.off("ready",h),e.clean()}),()=>{})),{engine:e,index:n,progress:r,canScrollPrev:u,canScrollNext:a}};export{Re as u};
